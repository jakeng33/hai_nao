###### library
import os
import sys


###### main

def checkfasta2(Input,Outdir):
	
	### open file
	data = open(Input)
	result = open(os.path.join(Outdir,os.path.basename('test2.txt')),'w')

	### create variable
	seqnum = 0 ## number of seq in file
	maxlen = 0 ## highest seq len in file
	sumlen = 0 ## sum len of all seq in file
	seqlen = 0 ## len of each seq in file
	GCnum  = 0 ## number of GC in each seq in file
	GCmax  = 0 ## the max GC content in file
	GCtotal= 0 ## sum number of GC in all of seq in file

	### logic =]] 

	for line in data :
		
		if line.startswith('>') == True :
			
			seqnum += 1
			sumlen += seqlen
			GCtotal+= GCnum
			
			if seqlen != 0 and (float(GCnum) / seqlen) > GCmax  :
				GCmax = float(GCnum) / seqlen

			seqlen = 0
			GCnum  = 0	
		else:
			for nu in line :
				if nu == 'G' or nu == 'C':
					GCnum += 1 

			seqlen += len(line[:-1])
			if seqlen > maxlen :
				maxlen = seqlen
	
	if  (float(GCnum) / seqlen) > GCmax  :
		GCmax = float(GCnum) / seqlen
	
	### write file 		

	result.write('The longest length: %i%s'%(maxlen,'\n'))

	result.write('The average length: %f%s'%(float(sumlen)/seqnum,'\n'))

	result.write('The highest GC content: %f%s'%(GCmax,'\n'))

	result.write('The average GC content: %f'%(float(GCtotal)/sumlen))


###### run

checkfasta2(*sys.argv[1:])





