###### library 
import os
import sys

###### main
def checkfasta4(Input,Outdir):

	### open file
	data = open(Input)
	result = open(os.path.join(Outdir,os.path.basename('test4_5.csv')),'w')

	###
	GC = 0
	seqlen = 0

	### create csv file contain group and GC content
	for line in data :
		if line.startswith('>') == True :
			if GC != 0 :
				result.write(group+'\t')
				result.write(str((float(GC)/seqlen))+'\n')
				GC = 0
				seqlen = 0
			
			if line[6] == '1' :
				group = '1'
			else :
				group = '2'
		else :
			seqlen += len(line[:-1])
			for nu in line :
				if nu == 'G' or nu == 'C' :
					GC += 1
		
	result.write(group+'\t')
	result.write(str((float(GC)/seqlen)))


###### run
checkfasta4(*sys.argv[1:])
	
